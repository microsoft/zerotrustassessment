# Universal Continuous Access Evaluation is enabled for Global Secure Access

## Spec Status

Draft

## Documentation Status

Not started

## Dev Status

Not started

## Minimum License

AAD_PREMIUM_P1, Entra_Premium_Internet_Access, Entra_Premium_Private_Access

## Pillar

Network

## SFI Pillar

Protect networks

## Category

Zero Trust Network Access (ZTNA), Continuous Access Evaluation

## Risk Level

Medium

## User Impact

Low

## Implementation Cost

Low

## Customer Facing Explanation

Universal Continuous Access Evaluation (Universal CAE) is a platform feature of Global Secure Access that continuously validates user access in near real-time whenever Microsoft Entra ID detects changes to user identity or device state. Unlike traditional token-based access that remains valid until expiration, Universal CAE revokes and revalidates network access immediately when security events occur, such as user disablement, password changes, or detection of high-risk sign-in activity.

Without Universal CAE enabled, organizations face a critical time window vulnerability: when an employee is terminated or a user account is compromised, the attacker can continue accessing network resources through Global Secure Access for up to 90 minutes (the default access token lifetime) because the system doesn't know the access permission has changed. During this window, a departing employee could exfiltrate sensitive data, or an attacker with a stolen token could laterally move through private networks and attack systems. Universal CAE eliminates this window by communicating identity changes to Global Secure Access in near real-time, forcing immediate reauthentication. When users cannot complete reauthentication (because their account is disabled or access is revoked), their network access is blocked immediately rather than after token expiration. This dramatically reduces the blast radius and dwell time of compromised accounts.

Risk Level: Medium - Without Universal CAE, there is a 90-minute window where access tokens remain valid despite account state changes, enabling lateral movement and data exfiltration by departed employees or attackers.

User Impact: Low - Universal CAE is transparent to users unless an access-revocation event occurs (e.g., account disabled, password reset); in those cases, users are prompted to reauthenticate.

Implementation Cost: Low - Universal CAE is enabled by default in Global Secure Access clients. Organizations only need to verify it is active in their Conditional Access configuration and optionally enable Strict Enforcement mode for enhanced security.

## Check Query

The assessment checks whether Universal Continuous Access Evaluation (CAE) is enabled in the tenant's Conditional Access configuration for Global Secure Access workloads.

### Query 1: Q1: Retrieve Conditional Access policies with CAE session controls

**Endpoint:** `https://graph.microsoft.com/v1.0/identity/conditionalAccess/policies`

**Documentation:** [Continuous access evaluation in Microsoft Entra](https://learn.microsoft.com/en-us/entra/identity/conditional-access/concept-continuous-access-evaluation) and [Session controls in Conditional Access policy](https://learn.microsoft.com/en-us/entra/identity/conditional-access/concept-conditional-access-session)

**Filter:** Policies targeting Global Secure Access workloads with session controls configured for CAE

**Property Check:** `grantControls.sessionControls.continuousAccessEvaluation` settings and `includeApplications` or `includeWorkloadIdentities` that reference Global Secure Access

**Pass Criteria:** At least one Conditional Access policy targets Global Secure Access (via workload identities) and explicitly enables or allows Continuous Access Evaluation through session controls

**Fail Criteria:** No Conditional Access policies are configured for Global Secure Access workloads, or policies exist but CAE is explicitly disabled in session controls

**Details:** Global Secure Access uses Microsoft Entra workload identities to authenticate. Universal CAE must be enabled in Conditional Access policy session controls for Global Secure Access tenants. By default, CAE is opportunistic (enabled when supported), but organizations can also implement Strict Enforcement mode for enhanced security.

### Query 2: Q2: Validate Strict Enforcement mode configuration (optional enhanced security)

**Endpoint:** `https://graph.microsoft.com/v1.0/identity/conditionalAccess/policies?$filter=includes('sessionControls.continuousAccessEvaluation.strictEnforcementEnabled')`

**Documentation:** [Continuous access evaluation strict location enforcement in Microsoft Entra ID](https://learn.microsoft.com/en-us/entra/identity/conditional-access/concept-continuous-access-evaluation-strict-enforcement)

**Property Check:** `sessionControls.continuousAccessEvaluation.strictEnforcementEnabled` property on policies targeting Global Secure Access

**Pass Criteria (Strict Enforcement):** If enabled, indicates highest security modality where access is blocked immediately if IP address doesn't match Conditional Access policy requirements

**Fail Criteria (Strict Enforcement):** Not configured; this is optional but recommended for organizations with strict security requirements

**Details:** This query checks for the optional Strict Enforcement mode of Universal CAE. When enabled, access is revoked if the IP address detected by the resource provider doesn't match the organization's Conditional Access policies. This requires understanding of network routing but provides the highest security level.

## User facing message

Pass: Universal Continuous Access Evaluation is enabled for Global Secure Access workloads, providing near real-time access revocation when user identity changes.

Fail: Universal Continuous Access Evaluation is not configured or disabled for Global Secure Access workloads, creating a time window for unauthorized access with valid tokens.

Investigate: Conditional Access policies exist but CAE configuration is unclear or only partially enabled for Global Secure Access.

## Test evaluation logic

1. Execute Query 1: Retrieve all Conditional Access policies with CAE session controls
2. Filter for policies that target Global Secure Access workloads (via workload identities or app-based targeting)
3. If no policies target Global Secure Access, test result is **Fail**
4. If at least one policy targets Global Secure Access and CAE is enabled (not explicitly disabled), test result is **Pass**
5. If policies exist but CAE is explicitly disabled (`continuousAccessEvaluation.isEnabled = false`), test result is **Fail**
6. Execute Query 2 to check if Strict Enforcement mode is configured (informational only, not required for pass)
7. If Strict Enforcement is enabled, append this to the Pass result as "with Strict Enforcement mode enabled"

## Test output data

The test returns information about Conditional Access policies that govern Global Secure Access access:
- Policy name
- Policy state (enabled/disabled)
- Target workloads or applications (Global Secure Access)
- CAE status (enabled/disabled)
- Strict Enforcement mode status (if configured)
- Last modified date
- Assigned users/groups

Link to Conditional Access policy portal: [Microsoft Entra Admin Center - Conditional Access Policies](https://entra.microsoft.com/#view/Microsoft_AAD_ConditionalAccess/ConditionalAccessBlade/~/Policies)

## Remediation resources

To enable Universal Continuous Access Evaluation for Global Secure Access in your organization, follow these steps:

1. **Understand Universal CAE**: Review the [Universal Continuous Access Evaluation concept documentation](https://learn.microsoft.com/en-us/entra/global-secure-access/concept-universal-continuous-access-evaluation) to understand how it protects your organization.

2. **Access Conditional Access**: Navigate to the Microsoft Entra admin center and go to Identity > Protection > Conditional Access. See [Getting started with Conditional Access](https://learn.microsoft.com/en-us/entra/identity/conditional-access/concept-conditional-access-policy-common).

3. **Create or modify a Conditional Access policy for Global Secure Access**: 
   - Create a new policy or modify an existing one that targets Global Secure Access workloads
   - See [How to configure Conditional Access policies](https://learn.microsoft.com/en-us/entra/identity/conditional-access/how-to-policy-adoption-recommendations)
   - Target "Global Secure Access" as the workload or include Global Secure Access service principal in your policy

4. **Enable Continuous Access Evaluation in session controls**:
   - In the policy, go to Session controls
   - Enable "Continuous Access Evaluation"
   - By default, this enables the opportunistic mode (recommended for most organizations)
   - See [Session controls documentation](https://learn.microsoft.com/en-us/entra/identity/conditional-access/concept-conditional-access-session)

5. **(Optional) Enable Strict Enforcement mode for enhanced security**:
   - In the CAE session control, check "Strict enforcement"
   - This ensures access is revoked immediately if the user's location (IP address) doesn't match the Conditional Access policy
   - Only enable if your organization has well-defined and stable network topologies
   - See [Strict Location Enforcement documentation](https://learn.microsoft.com/en-us/entra/identity/conditional-access/concept-continuous-access-evaluation-strict-enforcement)

6. **Ensure Global Secure Access client supports CAE**:
   - Update Global Secure Access clients to the latest version that supports Universal CAE
   - See [Global Secure Access client for Windows](https://learn.microsoft.com/en-us/entra/global-secure-access/how-to-install-windows-client)

7. **Monitor CAE effectiveness**:
   - Review audit logs to verify CAE events are being triggered
   - See [Continuous access evaluation troubleshooting](https://learn.microsoft.com/en-us/entra/identity/conditional-access/howto-continuous-access-evaluation-troubleshoot)

## API Testing and Validation Notes

### Query 1 Endpoint Validation
- **Endpoint**: `https://graph.microsoft.com/v1.0/identity/conditionalAccess/policies`
- **Status**: Stable v1.0 API endpoint
- **Expected Response**: Array of Conditional Access policy objects
- **Required Permissions**: Policy.Read.All or Policy.ReadWrite.ConditionalAccess role
- **Filter Complexity**: May need to parse `sessionControls` property to identify CAE configuration

### Query 2 Endpoint Validation
- **Endpoint**: `https://graph.microsoft.com/v1.0/identity/conditionalAccess/policies`
- **Status**: Stable v1.0 API endpoint; Strict Enforcement is documented in Learn but may have limited visibility in Graph
- **Dependencies**: Requires results from Query 1
- **Note for Developers**: Strict Enforcement mode property may be in `sessionControls.continuousAccessEvaluation.strictEnforcementEnabled`. Verify current schema in Microsoft Graph documentation.
